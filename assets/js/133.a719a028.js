(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{688:function(t,e,_){"use strict";_.r(e);var v=_(14),r=Object(v.a)({},(function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h2",{attrs:{id:"概述"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),_("p",[t._v("在读文件前，必须先打开文件。打开文件时，操作系统利用用户给出的路径名找到相应目录项。目录项中提供了查找文件磁盘块所需要的信息。因系统而异，这些信息有可能是整个文件的磁盘地址（对于连续分配方案）、第一个块的编号（对于两种链表分配方案）或者是i节点号。无论怎样，目录系统的主要功能是把ASCII文件名映射成定位文件数据所需的信息。")]),t._v(" "),_("h2",{attrs:{id:"基于inode的目录实现"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#基于inode的目录实现"}},[t._v("#")]),t._v(" 基于iNode的目录实现")]),t._v(" "),_("p",[t._v("基于 Linux 一切皆文件的设计思想，目录其实也是个文件，你甚至可以通过 "),_("code",[t._v("vim")]),t._v(" 打开它，它也有 inode，inode 里面也是指向一些块。")]),t._v(" "),_("p",[t._v("和普通文件不同的是，"),_("strong",[t._v("普通文件的块里面保存的是文件数据，而目录文件的块里面保存的是目录里面一项一项的文件信息。")])]),t._v(" "),_("p",[t._v("在目录文件的块中，最简单的保存格式就是"),_("strong",[t._v("列表")]),t._v("，就是一项一项地将目录下的文件信息（如文件名、文件 inode、文件类型等）列在表里。")]),t._v(" "),_("p",[t._v("列表中每一项就代表该目录下的文件的文件名和对应的 inode，通过这个 inode，就可以找到真正的文件。")]),t._v(" "),_("p",[_("img",{attrs:{src:"https://walegarrett-image-1304556108.cos.ap-chengdu.myqcloud.com/markdown_img/202204021039340.png",alt:""}})]),t._v(" "),_("p",[t._v("通常，第一项是「"),_("code",[t._v(".")]),t._v("」，表示当前目录，第二项是「"),_("code",[t._v("..")]),t._v("」，表示上一级目录，接下来就是一项一项的文件名和 inode。")]),t._v(" "),_("p",[t._v("如果一个目录有超级多的文件，我们要想在这个目录下找文件，按照列表一项一项的找，效率就不高了。")]),t._v(" "),_("p",[t._v("于是，保存目录的格式改成"),_("strong",[t._v("哈希表")]),t._v("，对文件名进行哈希计算，把哈希值保存起来，如果我们要查找一个目录下面的文件名，可以通过名称取哈希。如果哈希能够匹配上，就说明这个文件的信息在相应的块里面。")]),t._v(" "),_("p",[t._v("Linux 系统的 ext 文件系统就是采用了哈希表，来保存目录的内容，这种方法的优点是查找非常迅速，插入和删除也较简单，不过需要一些预备措施来避免哈希冲突。")]),t._v(" "),_("p",[t._v("目录查询是通过在磁盘上反复搜索完成，需要不断地进行 I/O 操作，开销较大。所以，为了减少 I/O 操作，把当前使用的文件目录缓存在内存，以后要使用该文件时只要在内存中操作，从而降低了磁盘操作次数，提高了文件系统的访问速度。")]),t._v(" "),_("h2",{attrs:{id:"参考"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),_("p",[_("a",{attrs:{href:"https://mp.weixin.qq.com/s/qJdoXTv_XS_4ts9YuzMNIw",target:"_blank",rel:"noopener noreferrer"}},[t._v("一口气搞懂「文件系统」，就靠这 25 张图了"),_("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=r.exports}}]);